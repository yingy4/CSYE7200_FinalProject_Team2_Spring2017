{"paragraphs":[{"text":"/**\n * Dependencies needed to be installed in Intepreters settings for Spark:\n * 1. org.apache.bahir:spark-streaming-twitter_2.11:2.1.0\n * 2. SentimentUtils class from our main project and its associated dependencies.\n *    This could be done by exporting it into a jar file and add it here in Zeppelin.\n */\n\nimport edu.neu.coe.scala.sentiment.SentimentUtils\nimport org.apache.log4j.{Level, Logger}\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\nimport org.apache.spark.streaming.twitter.TwitterUtils\n    \nval ssc = new StreamingContext(sc, Seconds(2))\n\nval ConsumerKey = \"yg3NK1BMfLx6dEE7UenZMMGiW\"\nval ConsumerSecret = \"MFwnagcHiyQMvkETkiZ613ngiWkKAKXN0lHVq6bW4g687G20R9\"\nval AccessToken = \"708481334482698240-QTn0EaokD6IVWFH0ZUhzlW48rdl42Qt\"\nval AccessSecret = \"7XfA0v9j0utKeUuf44n2YEB3AtzqVlMM0ue4IrJC0v2cK\"\n\nSystem.setProperty(\"twitter4j.oauth.consumerKey\", ConsumerKey)\nSystem.setProperty(\"twitter4j.oauth.consumerSecret\", ConsumerSecret)\nSystem.setProperty(\"twitter4j.oauth.accessToken\", AccessToken)\nSystem.setProperty(\"twitter4j.oauth.accessTokenSecret\", AccessSecret)\n\n// create a DStream from Twitter using our streaming context\nval twts = TwitterUtils.createStream(ssc, None)\nval tweets = twts.window(Seconds(300),  Seconds(2))\n\n// extract the text of each status update into DStreams using map()\nval statuses = tweets.filter(s => s.getLang == \"en\").map(status => (status.getText(), SentimentUtils.detectSentimentScore(status.getText())))\n\n// eliminate anything that's not a hashtag\nval hashtags = statuses.map(a => (a._1.split(\" \").filter(b => b.startsWith(\"#\")).headOption.getOrElse(\"NoHashTag\"), a._2))\n\n// map each hashtag to a key/value pair of (hashtag, 1) so we can count them up by adding up the values\nval hashtagKeyValues = hashtags.map(hashtag => (hashtag._1, (1, hashtag._2)))\n\n// count them up over a 5 minute window sliding every one second\nval hashtagCounts = hashtagKeyValues.reduceByKey((x, y) => (x._1 + y._1, x._2 + y._2))\n\nval hashtagCountsAveSentimentScore = hashtagCounts.map(hashtag => (hashtag._1, (hashtag._2._1, hashtag._2._2 / hashtag._2._1)))\n\n// sort the results by the count values\nval sortedResults = hashtagCountsAveSentimentScore.transform(rdd => rdd.sortBy(x => x._2._1, false))\n\nsqlContext.dropTempTable(\"tweets\")\n\nsortedResults.map(htg => (htg._1, htg._2._1, htg._2._2)).foreachRDD(rdd => rdd.toDF().registerTempTable(\"tweets\"))\n\n// print the top 10\nsortedResults.print\n\nssc.start()","user":"anonymous","dateUpdated":"2017-04-26T14:53:42-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport edu.neu.coe.scala.sentiment.SentimentUtils\n\nimport org.apache.log4j.{Level, Logger}\n\nimport org.apache.spark.SparkContext\n\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\n\nimport org.apache.spark.streaming.twitter.TwitterUtils\n\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@1dc5c2b9\n\nConsumerKey: String = yg3NK1BMfLx6dEE7UenZMMGiW\n\nConsumerSecret: String = MFwnagcHiyQMvkETkiZ613ngiWkKAKXN0lHVq6bW4g687G20R9\n\nAccessToken: String = 708481334482698240-QTn0EaokD6IVWFH0ZUhzlW48rdl42Qt\n\nAccessSecret: String = 7XfA0v9j0utKeUuf44n2YEB3AtzqVlMM0ue4IrJC0v2cK\n\nres1: String = null\n\nres2: String = null\n\nres3: String = null\n\nres4: String = null\n\ntwts: org.apache.spark.streaming.dstream.ReceiverInputDStream[twitter4j.Status] = org.apache.spark.streaming.twitter.TwitterInputDStream@66601416\n\ntweets: org.apache.spark.streaming.dstream.DStream[twitter4j.Status] = org.apache.spark.streaming.dstream.WindowedDStream@7fdff017\n\nstatuses: org.apache.spark.streaming.dstream.DStream[(String, Double)] = org.apache.spark.streaming.dstream.MappedDStream@3ce2749\n\nhashtags: org.apache.spark.streaming.dstream.DStream[(String, Double)] = org.apache.spark.streaming.dstream.MappedDStream@34bec17a\n\nhashtagKeyValues: org.apache.spark.streaming.dstream.DStream[(String, (Int, Double))] = org.apache.spark.streaming.dstream.MappedDStream@5557ff4d\n\nhashtagCounts: org.apache.spark.streaming.dstream.DStream[(String, (Int, Double))] = org.apache.spark.streaming.dstream.ShuffledDStream@24839327\n\nhashtagCountsAveSentimentScore: org.apache.spark.streaming.dstream.DStream[(String, (Int, Double))] = org.apache.spark.streaming.dstream.MappedDStream@220db015\n\nsortedResults: org.apache.spark.streaming.dstream.DStream[(String, (Int, Double))] = org.apache.spark.streaming.dstream.TransformedDStream@1025a534\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1491942066173_-891067431","id":"20170411-162106_1625812783","dateCreated":"2017-04-11T16:21:06-0400","dateStarted":"2017-04-26T14:34:51-0400","dateFinished":"2017-04-26T14:35:18-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4309"},{"text":"%sql select * from tweets limit ${top n = 10}","user":"anonymous","dateUpdated":"2017-04-26T15:05:13-0400","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":304,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"_1","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"_3","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{"top":"10","limit":"10","top n":" 10"},"forms":{"top n":{"name":"top n","defaultValue":" 10","hidden":false,"$$hashKey":"object:4419"}}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"_1\t_2\t_3\nNoHashTag\t8706\t1.4483115093039283\n#MiddleOfTheNight\t49\t1.8775510204081634\n#VideoLove\t42\t1.619047619047619\n#PREMIOSMTVMIAW\t13\t1.3846153846153846\n#np\t10\t1.2\n#AlienDay\t9\t1.7777777777777777\n#neetug17dateextension\t8\t1.25\n#CODWWII.\t8\t1.0\n#TreCru\t8\t1.625\n#QueTips\t8\t1.0\n"}]},"apps":[],"jobName":"paragraph_1491943417160_-1101979348","id":"20170411-164337_1336123777","dateCreated":"2017-04-11T16:43:37-0400","dateStarted":"2017-04-26T14:51:19-0400","dateFinished":"2017-04-26T14:53:34-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4310"},{"text":"%sql select count(_1) from tweets","user":"anonymous","dateUpdated":"2017-04-26T14:53:58-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(_1)\n1921\n"}]},"apps":[],"jobName":"paragraph_1491950069463_582488260","id":"20170411-183429_1203181679","dateCreated":"2017-04-11T18:34:29-0400","dateStarted":"2017-04-26T14:53:58-0400","dateFinished":"2017-04-26T14:58:07-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4311"},{"text":"%sql select sum(_2) as TotalNoOfTweets from tweets","user":"anonymous","dateUpdated":"2017-04-26T14:58:18-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"TotalNoOfTweets\n16896\n"}]},"apps":[],"jobName":"paragraph_1493232447299_-1054866531","id":"20170426-144727_168719480","dateCreated":"2017-04-26T14:47:27-0400","dateStarted":"2017-04-26T14:58:18-0400","dateFinished":"2017-04-26T15:03:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4312"},{"text":"ssc.stop(false, true)","user":"anonymous","dateUpdated":"2017-04-26T15:06:38-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1492449922356_-1999536271","id":"20170417-132522_190847968","dateCreated":"2017-04-17T13:25:22-0400","dateStarted":"2017-04-26T15:06:38-0400","dateFinished":"2017-04-26T15:19:41-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4313"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492450465809_-1979178516","id":"20170417-133425_1167924822","dateCreated":"2017-04-17T13:34:25-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4314"}],"name":"7200Final/popularHashtags","id":"2CDENPC62","angularObjects":{"2CFJ36ME7:shared_process":[],"2CE9PJFGM:shared_process":[],"2CCNM2DM6:shared_process":[],"2CDQXG3KB:shared_process":[],"2CDQGXA55:shared_process":[],"2CFP4DBJV:shared_process":[],"2CEJH4AKM:shared_process":[],"2CESVVEM7:shared_process":[{"name":"txt","object":"test"},{"name":"latittude","object":42.3398}],"2CDP3N3M1:shared_process":[],"2CFJMSWAF:shared_process":[],"2CDKU9GBG:shared_process":[],"2CF56FVPZ:shared_process":[],"2CD5K62NZ:shared_process":[],"2CCBHEMW2:shared_process":[],"2CCE4SMDU:shared_process":[],"2CFMN9NEB:shared_process":[],"2CCDUTQVT:shared_process":[],"2CEUHNK87:shared_process":[],"2CCWYNHK2:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}